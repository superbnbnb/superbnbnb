$(function(){function a(){}function b(){$("#btn-connect").removeClass("hide"),$("#connectedAddress").html(""),$("#introPanel").removeClass("hide"),$("#matrixDiv").addClass("hide"),$("#matrixDivX6").addClass("hide")}function c(){$("#btn-connect").removeClass("hide").addClass("hide"),$("#connectedAddress").html(aa.substring(0,4)+"..."+aa.substring(aa.length-4)+"<br/><a>Disconnect</a>"),$("#referredBy").html(d(ba)),$("#profileAddress").html(d(aa)),$("#introPanel").removeClass("hide").addClass("hide"),$("#profilePanel").removeClass("hide")}function d(a){return ca?a.substring(0,15)+"...":a}async function e(){N.methods.users(aa).call(function(a,b){a||(0<b.id?(c(),$("#profilePanelRegisterSection").addClass("hide"),$("#profilePanelRegistered").removeClass("hide"),$("#refURL").val("https://BSCMATRIX.com/?ref="+aa),$("#playerID").html(b.id),$("#matrixParent").html(d(b.referrer)),$("#totalInvitedPartners").html(b.partnersCount),$("#totalDividendEarnings").html(new BigNumber(b.divsClaimed).div(ea).toFixed(4)+" BNB"),f(g(i(k))),setTimeout(function(){e()},15e3)):(c(),i()))})}function f(a){O&&O.methods.balanceOf(aa).call(function(b,c){b||($("#matrixTokens").html(new BigNumber(c).div(ea).toFixed(2)),$("#matrixTokens2").html(new BigNumber(c).div(ea).toFixed(2)),a&&a())})}function g(a){O&&O.methods.stakeOf(aa).call(function(b,c){b||(fa=new BigNumber(c),$("#matrixStaked").html(new BigNumber(c).div(ea).toFixed(2)),$("#matrixStaked2").html(new BigNumber(c).div(ea).toFixed(2)),a&&a())})}function h(a){O&&O.methods.totalStakes().call(function(b,c){b||(ga=new BigNumber(c),$("#totalMatrixStaked2").html(new BigNumber(c).div(ea).toFixed(2)),a&&a())})}function i(a){N.methods.divStats(aa).call(function(b,c){if(!b){$("#newDivs").html(new BigNumber(c._playerDivs).div(ea).toFixed(5)+" BNB"),0<+c._playerDivs&&$("#withdrawBtn").removeClass("hide"),$("#weeklyDivPool").html(new BigNumber(c._divPoolSize).div(ea).toFixed(4)+" BNB"),ha=new Date(1e3*+c._currentDivPoolStartTs+1e3*+c._divPoolDuration),$("#totalPlayers").html(c._lastUserId-1);let a=new BigNumber(c._totalDivs).div(2).times(100);$("#totalBNB").html(a.div(ea).toFixed(2));let b=a.div(ea).times(new BigNumber(Ia)),d=a.div(ea).times(Ja);$("#totalBTC").html(b.toFixed(4)),$("#totalUSD").html(d.toFixed(2)),$("#divShare").html(+c._playerPercent/100+"%")}a&&a()})}function j(){if(!ha)return void setTimeout(function(){j()},1e3);var a=new Date,b=ha.getTime()-a.getTime();if(0>b)return $("#divDistPeriod").html("anytime now"),void setTimeout(function(){j()},1e3);var c=Math.floor(b/1e3/60/60/24);b-=24*(60*(60*(1e3*c)));var d=Math.floor(b/1e3/60/60);b-=60*(60*(1e3*d));var e=Math.floor(b/1e3/60);b-=60*(1e3*e);var f=Math.floor(b/1e3),g="";1==c&&(g+=c+" day "),1<c&&(g+=c+" days "),1==d&&(g+=d+" hour "),1<d&&(g+=d+" hours "),1==e&&(g+=e+" minute "),1<e&&(g+=e+" minutes "),1==f&&(g+=f+" second"),1<f&&(g+=f+" seconds"),$("#divDistPeriod").html(g),setTimeout(function(){j()},1e3)}function k(){$("#matrixDiv").removeClass("hide"),$("#matrixDivX6").removeClass("hide"),ua=new BigNumber(0),w(1)}function l(a){return function(){document.execCommand("copy",!1,a.select())}}function m(){var b=document.querySelector(".js-shareUrl"),c=l(b);b.addEventListener("click",function(){c(),L("Your REF URL has been copied to your clipboard ready for you to share!")},!1),C(),j();var d=M("ref")||"";if(0<d.length)ba=d;else{let a=Cookies.get("ref")||"";0<a.length&&(ba=a)}ba||(console.log("NO REF"),ba=T),"undefined"==ba&&(console.log("NO REF2"),ba=T),Cookies.set("ref",ba,{expires:60}),console.log("REF:",ba),ba&&(Da=ba.substring(0,20)+"...");Z=new U({network:"binance",cacheProvider:!1,providerOptions:{walletconnect:{package:V,options:{rpc:{56:S},network:"binance"}}},disableInjectedProvider:!1}),a(),console.log("Web3Modal instance is",Z)}async function n(){P=new Web3(_),console.log("Web3 instance is",P);const a=await P.eth.getChainId(),c=W.getChain(a);if(a!=R)return void $("#wrongChainError").foundation("open");$("#connectBeforeStats").addClass("hide"),$("#connectBeforeStats2").addClass("hide"),$("#statsPanel1").removeClass("hide"),$("#statsPanel2").removeClass("hide"),console.log("NETWORK NAME:",c.name);const d=await P.eth.getAccounts();console.log("Got accounts",d),aa=d[0];const f=document.querySelector("#template-balance"),g=document.querySelector("#accounts"),h=d.map(async a=>{const b=await P.eth.getBalance(a),c=P.utils.fromWei(b,"ether"),d=parseFloat(c).toFixed(4)});aa?e():b(),await Promise.all(h)}async function o(){const a=await new Web3(_);N=new a.eth.Contract(bscmatrixAbi.abi,X),O=new a.eth.Contract(matrixAbi.abi,Y),await n(_)}async function p(){console.log("Opening a dialog",Z);try{_=await Z.connect()}catch(a){return void console.log("Could not get a wallet connection",a)}_.on("accountsChanged",()=>{n()}),_.on("chainChanged",()=>{n()}),_.on("networkChanged",()=>{n()}),await o()}async function q(){console.log("Killing the wallet connection",_),_.close&&(await _.close(),await Z.clearCachedProvider(),_=null),aa=null,b()}function r(){let a=$("#autoStake").is(":checked");N&&N.methods.isUserExists(ba).call(function(b,c){let d=!0;if(b)return console.log(b),void L("An error occured sending your transaciton - please ensure you have enough funds and try again","Error with transaciton",15e3);!1==c&&(d=!1);d||(ba=T),console.log("Registering with ref of:",ba,aa,va[0].times(2).toString()),$("#loadingDiv").removeClass("hide"),ca&&(Pa=0,K()),N.methods.registrationExt(ba,a).send({from:aa,value:va[0].times(2)},function(a){return a?($("#loadingDiv").addClass("hide"),void L("An error occured sending your transaciton - please ensure you have enough funds and try again","Error with transaciton",15e3)):void(ca||(Pa=0,K()))})})}async function s(a){return ya=new Web3.providers.WebsocketProvider("wss://mainnet.infura.io/ws/v3/0748533f2e3f4a90ad830c47e2ff9f5c"),za=await new Web3(ya),Aa=new za.eth.Contract(ethmatrixbonusAbi.abi,"0xae98b0e0c112b6d85ba32ff521b051f3fb2bafab"),void(a&&a())}function t(a){_contract=Aa,_contract.methods.lastUserId().call(function(b,d){if(console.log(b,d),!b){if(a)_playerCount=parseInt(d);else if(parseInt(d)>_playerCount){for(let a=_playerCount+1;a<=d;a++)L("Player ID# "+a+" has joined the game!","Welcome new Player!");_playerCount=parseInt(d)}$("#totalPlayers").html(d)}}),_contract.methods.totalDivs().call(function(a,b){if(!a){let a=new BigNumber(b),c=a.div(2).times(100),d=c.div(ea).div(new BigNumber(exchange_btc_eth)),e=d.times(exchange_btc_usd);$("#totalEth").html(c.div(ea).toFixed(3)),$("#totalBTC").html(d.toFixed(4)),$("#totalUSD").html("$"+e.toFixed(2)+" USD"),$("#ethEarned").html(c.div(ea).toFixed(3)+" ($"+e.toFixed(0)+" USD!)")}})}function u(){xa=new Web3(window.web3.currentProvider),checkNetwork(v)}function v(){function a(){s(function(){getUserWalletAddress(function(){setupUser()})})}console.log("STARTING GAME"),jQuery.timeago.settings.allowFuture=!0,ca?setTimeout(function(){a()},1e3):a()}function w(a){N.methods.userEarnings(aa,a).call(function(b,c){if(!b)if(sa[+(a-1)]=new BigNumber(c.x3MatrixEarnings),ta[+(a-1)]=new BigNumber(c.x6MatrixEarnings),ua=ua.plus(new BigNumber(c.x3MatrixEarnings)),ua=ua.plus(new BigNumber(c.x6MatrixEarnings)),$("#x3_level"+a+"_earned").html(sa[+(a-1)].div(ea).toFixed(3)),$("#x6_level"+a+"_earned").html(ta[+(a-1)].div(ea).toFixed(3)),13>a)w(a+1);else{$("#totalMatrixEarnings").html(ua.div(ea).toFixed(3)+" BNB");let a=ua.div(ea).times(Ja);$("#totalEarningsUSD").html("$"+a.toFixed(2)+" USD"),N.methods.usersActiveLevelsAll(aa).call(function(a,b){if(!a){for(let a=0;a<b.x3LevelsActive.length;a++)ia[a]=b.x3LevelsActive[a],ja[a]=b.x6LevelsActive[a];y(1)}})}})}function x(a){let b=!1,c=+(a+500000);P.eth.getBlockNumber(function(d,e){e<=c&&(b=!0,c="latest");let f=N;f.getPastEvents("NewUserPlace",{filter:{referrer:aa},fromBlock:a,toBlock:c},function(b,d){if(d){for(let a=0;a<d.length;a++)1==d[a].returnValues.matrix?ka[+d[a].returnValues.level-1].push(d[a]):oa[+d[a].returnValues.level-1].push(d[a]);for(let a=0;12>a;a++)$("#x3_level"+ +(a+1)+"_partners").html(ka[a].length),$("#x6_level"+ +(a+1)+"_partners").html(oa[a].length)}f.getPastEvents("Reinvest",{filter:{user:aa},fromBlock:a,toBlock:c},function(b,d){if(d){for(let a=0;a<d.length;a++)1==d[a].returnValues.matrix?la[+d[a].returnValues.level-1].push(d[a]):pa[+d[a].returnValues.level-1].push(d[a]);for(let a=0;12>a;a++)$("#x3_level"+ +(a+1)+"_reinvests").html(la[a].length),$("#x6_level"+ +(a+1)+"_reinvests").html(pa[a].length)}f.getPastEvents("MissedFundsReceive",{filter:{receiver:aa},fromBlock:a,toBlock:c},function(b,d){if(d){for(let a=0;a<d.length;a++)1==d[a].returnValues.matrix&&(ma[+d[a].returnValues.level-1].push(d[a]),qa[+d[a].returnValues.level-1].push(d[a]));for(let a=0;12>a;a++)$("#x3_level"+ +(a+1)+"_missed").html(ma[a].length),$("#x3_level"+ +(a+1)+"_missed2").html(ma[a].length),$("#x6_level"+ +(a+1)+"_missed").html(qa[a].length),$("#x6_level"+ +(a+1)+"_missed2").html(qa[a].length)}f.getPastEvents("SentExtraFundsDividends",{filter:{receiver:aa},fromBlock:a,toBlock:c},function(a,b){if(b){for(let a=0;a<b.length;a++)1==b[a].returnValues.matrix&&(na[+b[a].returnValues.level-1].push(b[a]),ra[+b[a].returnValues.level-1].push(b[a]));for(let a=0;12>a;a++)$("#x3_level"+ +(a+1)+"_extras").html(na[a].length),$("#x6_level"+ +(a+1)+"_extras").html(ra[a].length)}})})})}),b||x(a+5e5+1)})}function y(a){if(!0==ia[a])$("#x3_level"+a+"_stats").removeClass("hide"),$("#x3_level"+a+"_buy").removeClass("hide"),$("#x3_level"+a+"_buy").addClass("hide"),$("#x3_level"+a+"_matrix").removeClass("disabled2"),$("#x3_level"+a).removeClass("disabled"),N.methods.usersX3Matrix(aa,a).call(function(b,d){N.methods.users(d[0]).call(function(b,c){b||($("#x3_level"+a+"_referrer").html(c.id),$("#x3_level"+a+"_referrer").attr("title","Current Referrer ID:"+c.id+", Addr:"+d[0]))}),!0==d[2]&&($("#x3_level"+a).addClass("disabled"),L("Level "+a+" is blocked for further partner payments until you upgrade to the next level!","Upgrade needed",3e4));for(let e=0;e<d[1].length;e++)N.methods.users(d[1][e]).call(function(b,c){$("#x3_idOfLevel"+a+"_"+ +(e+1)).html(c.id),$("#x3_idOfLevel"+a+"_"+ +(e+1)).attr("title","Partner ID:"+c.id+", Addr:"+d[1][e])});13>a?y(a+1):z(1)});else{$("#x3_level"+a+"_stats").removeClass("hide"),$("#x3_level"+a+"_stats").addClass("hide"),$("#x3_level"+a+"_buy").removeClass("hide"),$("#x3_level"+a+"_matrix").removeClass("disabled2"),$("#x3_level"+a+"_matrix").addClass("disabled2"),$("#x3_level"+a).removeClass("disabled");for(let b=+(a+1);13>b;b++)$("#x3_level"+b).removeClass("disabled"),$("#x3_level"+b).addClass("disabled");z(1)}}function z(a){if(!0==ja[a])$("#x6_level"+a+"_stats").removeClass("hide"),$("#x6_level"+a+"_buy").removeClass("hide"),$("#x6_level"+a+"_buy").addClass("hide"),$("#x6_level"+a+"_matrix").removeClass("disabled2"),$("#x6_level"+a).removeClass("disabled"),N.methods.usersX6Matrix(aa,a).call(function(b,d){N.methods.users(d[0]).call(function(b,c){b||($("#x6_level"+a+"_referrer").html(c.id),$("#x6_level"+a+"_referrer").attr("title","Current Referrer ID:"+c.id+", Addr:"+d[0]))}),!0==d[3]&&($("#x6_level"+a).addClass("disabled"),L("Level "+a+" is blocked for further partner payments until you upgrade to the next level!","Upgrade needed",3e4));for(let e=0;e<d[1].length;e++)N.methods.users(d[1][e]).call(function(b,c){$("#x6_idOfLevel"+a+"_1_"+ +(e+1)).html(c.id),$("#x6_idOfLevel"+a+"_1_"+ +(e+1)).attr("title","Partner ID:"+c.id+", Addr:"+d[1][e])});for(let e=0;e<d[2].length;e++)N.methods.users(d[2][e]).call(function(b,c){$("#x6_idOfLevel"+a+"_2_"+ +(e+1)).html(c.id),$("#x6_idOfLevel"+a+"_2_"+ +(e+1)).attr("title","Partner ID:"+c.id+", Addr:"+d[2][e])});13>a?z(a+1):x(Q)});else{$("#x6_level"+a+"_stats").removeClass("hide"),$("#x6_level"+a+"_stats").addClass("hide"),$("#x6_level"+a+"_buy").removeClass("hide"),$("#x6_level"+a+"_matrix").removeClass("disabled2"),$("#x6_level"+a+"_matrix").addClass("disabled2"),$("#x6_level"+a).removeClass("disabled");for(let b=+(a+1);13>b;b++)$("#x6_level"+b).removeClass("disabled"),$("#x6_level"+b).addClass("disabled");x(Q)}}function A(){var a=window.open("https://BSCMATRIX.com/BSCMatrix.pdf","_blank");a.focus()}function B(a){$.ajax({type:"GET",url:"https://api.bscscan.com/api?module=stats&action=bnbprice&apikey=YourApiKeyToken",data:{get_param:"value"},dataType:"json",success:function(b){Ia=b.result.ethbtc,Ja=b.result.ethusd,console.log("exchange_eth_btc:",Ia),console.log("exchange_eth_usd:",Ja),a&&a()},error:function(){a&&a()}})}function C(){const a=new Date(2021,2,10),b=new Date,c=Math.round(Math.abs((a-b)/86400000));console.log("ACTIVE DAYS:",c),1<c?$("#activeDays").html(+(c-1)+" days"):$("#activeDays").html(+(c-1)+" day")}function D(){N&&($("#loadingDiv").removeClass("hide"),N.methods.claimDivs().send({from:aa},function(a){return a?($("#loadingDiv").addClass("hide"),void L("An error occured sending your transaciton - please ensure you have enough gas and try again","Error with transaciton",15e3)):void($("#loadingDiv").addClass("hide"),$("#newDivs").html("0 BNB"),$("#withdrawBtn").addClass("hide"),L("Dividends are being processed by the blockchain and will be in your wallet shortly!","Withdrawing Dividends",3e4))}))}function E(){O&&O.methods.autoStake(aa).call(function(a,b){a||($("#autoStake2").prop("checked",b),f(g(h(function(){$("#stakeShare2").html(fa.div(ga).times(100).toFixed(2)),$("#manageStake").foundation("open")}))))})}function F(){let a=new BigNumber($("#unstakeAmount").val()).times(ea);N&&N.methods.unstake(a.toString()).send({from:aa},function(a){return a?void L("An error occured sending your transaciton - please ensure you have enough funds and try again","Error with transaciton",15e3):void(L("You're stake has been adjusted and will updated on the blockchain shortly!","BSCMATRIX"),$("#manageStake").foundation("close"))})}function G(){let a=new BigNumber($("#stakeAmount").val()).times(ea);N&&N.methods.stake(a.toString()).send({from:aa},function(a){return a?void L("An error occured sending your transaciton - please ensure you have enough funds and try again","Error with transaciton",15e3):void(L("You're stake has been adjusted and will updated on the blockchain shortly!","BSCMATRIX"),$("#manageStake").foundation("close"))})}function H(){let a=$("#autoStake2").is(":checked");O&&O.methods.setAutoStake(aa,a).send({from:aa},function(a){return a?void L("An error occured sending your transaciton - please ensure you have enough funds and try again","Error with transaciton",15e3):void(L("You're settings have been updated!","BSCMATRIX"),$("#manageStake").foundation("close"))})}function I(a,b){N&&($("#loadingDiv").removeClass("hide"),ca&&(Ma=0,Na=b,Oa=a,J()),N.methods.buyNewLevel(a,b).send({from:aa,value:va[b-1]},function(c){return c?($("#loadingDiv").addClass("hide"),void L("An error occured sending your transaciton - please ensure you have enough funds and try again","Error with transaciton",15e3)):void(ca||(Ma=0,Na=b,Oa=a,J()))}))}function J(){console.log("CHECK BUY COMPLETE:",Ma),1==Oa?N.methods.usersActiveX3Levels(aa,Na).call(function(a,b){!0==b?($("#loadingDiv").addClass("hide"),setTimeout(function(){e()},1500)):500>Ma?setTimeout(function(){Ma++,J()},1500):($("#loadingDiv").addClass("hide"),L("An error occured checking your transaction - please refresh the page to check confirmation","Error with transaciton",15e3))}):N.methods.usersActiveX6Levels(aa,Na).call(function(a,b){!0==b?($("#loadingDiv").addClass("hide"),setTimeout(function(){e()},1500)):500>Ma?setTimeout(function(){Ma++,J()},1500):($("#loadingDiv").addClass("hide"),L("An error occured checking your transaction - please refresh the page to check confirmation","Error with transaciton",15e3))})}function K(){console.log("CHECK USER COMPLETE:",Pa),N.methods.users(aa).call({from:aa},function(a,b){0<b.id?($("#loadingDiv").addClass("hide"),setTimeout(function(){e()},1500)):500>Pa?setTimeout(function(){Pa++,K()},1500):($("#loadingDiv").addClass("hide"),L("An error occured checking your transaction - please refresh the page to check confirmation","Error with transaciton",15e3))})}function L(a,b,c){$.toast({text:a,heading:b||"BSCMATRIX",showHideTransition:"fade",allowToastClose:!0,hideAfter:c||6e3,stack:5,position:"bottom-right",bgColor:"#ff3cbe",textColor:"#eeeeee",textAlign:"left",loader:!0,loaderBg:"#9EC600",beforeShow:function(){},afterShown:function(){},beforeHide:function(){},afterHidden:function(){}})}function M(a){var b,c,d=decodeURIComponent(window.location.search.substring(1)),e=d.split("&");for(c=0;c<e.length;c++)if(b=e[c].split("="),b[0]===a)return void 0===b[1]||b[1]}var N,O,P;const Q=6961960,R=56,S="https://bsc-dataseed1.defibit.io/",T="0x1809F0234302e2b5dfb192832AfdEd04D6616052",U=window.Web3Modal.default,V=window.WalletConnectProvider.default,W=window.evmChains,X="0x620Ac0fbc091024EF549573777aF834052Cf77e7",Y="0x6Bb13cA7d191dc1B0884A0d159994C2461a5fE31";let Z,_,aa;var ba,ca=!1,da=window.matchMedia("only screen and (pointer:coarse)");da.matches&&(ca=!0);const ea=1e18;var fa,ga,ha,ia=Array(12),ja=Array(12),ka=Array(12),la=Array(12),ma=Array(12),na=Array(12),oa=Array(12),pa=Array(12),qa=Array(12),ra=Array(12),sa=Array(12),ta=Array(12),ua=new BigNumber(0);for(let a=0;12>a;a++)ka[a]=[],oa[a]=[],la[a]=[],pa[a]=[],ma[a]=[],qa[a]=[],na[a]=[],ra[a]=[],sa[a]=new BigNumber(0),ta[a]=new BigNumber(0);var va=[];va[0]=new BigNumber(25e15);for(let a=1;12>a;a++)va[a]=new BigNumber(va[a-1]).times(2);var wa=1e10;$(document).foundation(),m(),function(){$.ajax({type:"GET",url:"https://api.bscscan.com/api?module=proxy&action=eth_gasPrice&apikey=YourApiKeyToken",data:{get_param:"value"},dataType:"json",success:function(a){wa=parseInt(a.result),console.log("GAS:",wa)},error:function(){wa=1e10}})}(),B(),document.querySelector("#unlockBtn").addEventListener("click",p),document.querySelector("#btn-connect").addEventListener("click",p),document.querySelector("#connectedAddress").addEventListener("click",q),document.querySelector("#registerBtn").addEventListener("click",r,!1),document.querySelector("#withdrawBtn").addEventListener("click",D,!1),document.querySelector("#stakingBtn").addEventListener("click",E,!1),document.querySelector("#unstakeBtn").addEventListener("click",F,!1),document.querySelector("#stakeBtn").addEventListener("click",G,!1),document.querySelector("#autostakeBtn").addEventListener("click",H,!1),document.querySelector("#viewContractBtn").addEventListener("click",function(){var a=window.open("https://bscscan.com/address/0x620Ac0fbc091024EF549573777aF834052Cf77e7","_blank");a.focus()},!1),document.querySelector("#gameGudeBtn").addEventListener("click",A,!1),document.querySelector("#viewGuideBtn").addEventListener("click",A,!1);for(let a=2;13>a;a++)document.querySelector("#x3BuyBtn_level"+a).addEventListener("click",function(){I(1,a)});for(let a=2;13>a;a++)$("#x6BuyBtn_level"+a).click(function(){I(2,a)});var xa,ya,za,Aa,Ba,Ca,ba,Da,ca=!1,Ea=!1,Fa=!1,Ga=!1;var Ha=M("ref")||"";var Ia=.005102,Ja=281.26;var Ka=0,La="",Ma=0,Na=0,Oa=0,Pa=0,Qa=new BigNumber(0),Ra=new BigNumber(0),Sa=[],Ta=0,Ua=0,Va=0,Wa=[0,0,0,0,0,0,0,0,0,0],Xa=[0,0,0,0,0,0,0,0,0,0]});